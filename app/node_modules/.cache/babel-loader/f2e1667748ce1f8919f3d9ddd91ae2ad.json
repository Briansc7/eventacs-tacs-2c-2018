{"ast":null,"code":"/*\n\n\n*/\nvar moment = require('moment');\n\nvar Parser = require('../parser').Parser;\n\nvar ParsedResult = require('../../result').ParsedResult;\n\nvar PATTERN = /(\\W|^)(dentro\\s*de|en)\\s*([0-9]+|medi[oa]|una?)\\s*(minutos?|horas?|d[ií]as?)\\s*(?=(?:\\W|$))/i;\n\nexports.Parser = function ESDeadlineFormatParser() {\n  Parser.apply(this, arguments);\n\n  this.pattern = function () {\n    return PATTERN;\n  };\n\n  this.extract = function (text, ref, match, opt) {\n    var index = match.index + match[1].length;\n    var text = match[0];\n    text = match[0].substr(match[1].length, match[0].length - match[1].length);\n    var result = new ParsedResult({\n      index: index,\n      text: text,\n      ref: ref\n    });\n    var num = parseInt(match[3]);\n\n    if (isNaN(num)) {\n      if (match[3].match(/medi/)) {\n        num = 0.5;\n      } else {\n        num = 1;\n      }\n    }\n\n    var date = moment(ref);\n\n    if (match[4].match(/d[ií]a/)) {\n      date.add(num, 'd');\n      result.start.assign('year', date.year());\n      result.start.assign('month', date.month() + 1);\n      result.start.assign('day', date.date());\n      return result;\n    }\n\n    if (match[4].match(/hora/)) {\n      date.add(num, 'hour');\n    } else if (match[4].match(/minuto/)) {\n      date.add(num, 'minute');\n    }\n\n    result.start.imply('year', date.year());\n    result.start.imply('month', date.month() + 1);\n    result.start.imply('day', date.date());\n    result.start.assign('hour', date.hour());\n    result.start.assign('minute', date.minute());\n    result.tags['ESDeadlineFormatParser'] = true;\n    return result;\n  };\n};","map":null,"metadata":{},"sourceType":"script"}