{"ast":null,"code":"/*\r\n    Date format with slash \"/\" (also \"-\" and \".\") between numbers\r\n    - Martes 3/11/2015\r\n    - 3/11/2015\r\n    - 3/11\r\n*/\nvar moment = require('moment');\n\nvar Parser = require('../parser').Parser;\n\nvar ParsedResult = require('../../result').ParsedResult;\n\nvar PATTERN = new RegExp('(\\\\W|^)' + '(?:' + '((?:dimanche|dim|lundi|lun|mardi|mar|mercredi|mer|jeudi|jeu|vendredi|ven|samedi|sam|le))' + '\\\\s*\\\\,?\\\\s*' + ')?' + '([0-3]{0,1}[0-9]{1})[\\\\/\\\\.\\\\-]([0-3]{0,1}[0-9]{1})' + '(?:' + '[\\\\/\\\\.\\\\-]' + '([0-9]{4}\\s*\\,?\\s*|[0-9]{2}\\s*\\,?\\s*)' + ')?' + '(\\\\W|$)', 'i');\nvar DAYS_OFFSET = {\n  'dimanche': 0,\n  'dim': 0,\n  'lundi': 1,\n  'lun': 1,\n  'mardi': 2,\n  'mar': 2,\n  'mercredi': 3,\n  'mer': 3,\n  'jeudi': 4,\n  'jeu': 4,\n  'vendredi': 5,\n  'ven': 5,\n  'samedi': 6,\n  'sam': 6\n};\nvar OPENNING_GROUP = 1;\nvar ENDING_GROUP = 6; // In French we use day/month/year\n\nvar WEEKDAY_GROUP = 2;\nvar DAY_GROUP = 3;\nvar MONTH_GROUP = 4;\nvar YEAR_GROUP = 5;\n\nexports.Parser = function FRSlashDateFormatParser(argument) {\n  Parser.apply(this, arguments);\n\n  this.pattern = function () {\n    return PATTERN;\n  };\n\n  this.extract = function (text, ref, match, opt) {\n    if (match[OPENNING_GROUP] == '/' || match[ENDING_GROUP] == '/') {\n      // Long skip, if there is some overlapping like:\n      // XX[/YY/ZZ]\n      // [XX/YY/]ZZ\n      match.index += match[0].length;\n      return;\n    }\n\n    var index = match.index + match[OPENNING_GROUP].length;\n    var text = match[0].substr(match[OPENNING_GROUP].length, match[0].length - match[ENDING_GROUP].length);\n    var result = new ParsedResult({\n      text: text,\n      index: index,\n      ref: ref\n    });\n    if (text.match(/^\\d\\.\\d$/)) return;\n    if (text.match(/^\\d\\.\\d{1,2}\\.\\d{1,2}$/)) return; // MM/dd -> OK\n    // MM.dd -> NG\n\n    if (!match[YEAR_GROUP] && match[0].indexOf('/') < 0) return;\n    var date = null;\n    var year = match[YEAR_GROUP] || moment(ref).year() + '';\n    var month = match[MONTH_GROUP];\n    var day = match[DAY_GROUP];\n    day = parseInt(day);\n    month = parseInt(month);\n    year = parseInt(year);\n\n    if (month < 1 || month > 12) {\n      if (month > 12) {\n        // dd/mm/yyyy date format if day looks like a month, and month looks like a day.\n        if (day >= 1 && day <= 12 && month >= 13 && month <= 31) {\n          // unambiguous\n          var tday = month;\n          month = day;\n          day = tday;\n        } else {\n          // both month and day are <= 12\n          return null;\n        }\n      }\n    }\n\n    if (day < 1 || day > 31) return null;\n\n    if (year < 100) {\n      if (year > 50) {\n        year = year + 1900;\n      } else {\n        year = year + 2000;\n      }\n    }\n\n    result.start.assign('day', day);\n    result.start.assign('month', month);\n    result.start.assign('year', year); // Day of week\n\n    if (match[WEEKDAY_GROUP]) {\n      result.start.assign('weekday', DAYS_OFFSET[match[WEEKDAY_GROUP].toLowerCase()]);\n    }\n\n    result.tags['FRSlashDateFormatParser'] = true;\n    return result;\n  };\n};","map":null,"metadata":{},"sourceType":"script"}