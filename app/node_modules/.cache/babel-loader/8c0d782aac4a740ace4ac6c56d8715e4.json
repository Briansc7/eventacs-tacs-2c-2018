{"ast":null,"code":"/*\n    ISO 8601\n    http://www.w3.org/TR/NOTE-datetime\n    - YYYY-MM-DD\n    - YYYY-MM-DDThh:mmTZD\n    - YYYY-MM-DDThh:mm:ssTZD\n    - YYYY-MM-DDThh:mm:ss.sTZD \n    - TZD = (Z or +hh:mm or -hh:mm)\n*/\nvar moment = require('moment');\n\nvar Parser = require('../parser').Parser;\n\nvar ParsedResult = require('../../result').ParsedResult;\n\nvar PATTERN = new RegExp('(\\\\W|^)' + '([0-9]{4})\\\\-([0-9]{1,2})\\\\-([0-9]{1,2})' + '(?:T' //..\n+ '([0-9]{1,2}):([0-9]{1,2})' // hh:mm\n+ '(?::([0-9]{1,2})(?:\\\\.(\\\\d{1,4}))?)?' // :ss.s\n+ '(?:Z|([+-]\\\\d{2}):?(\\\\d{2})?)?' // TZD (Z or ±hh:mm or ±hhmm or ±hh)\n+ ')?' //..\n+ '(?=\\\\W|$)', 'i');\nvar YEAR_NUMBER_GROUP = 2;\nvar MONTH_NUMBER_GROUP = 3;\nvar DATE_NUMBER_GROUP = 4;\nvar HOUR_NUMBER_GROUP = 5;\nvar MINUTE_NUMBER_GROUP = 6;\nvar SECOND_NUMBER_GROUP = 7;\nvar MILLISECOND_NUMBER_GROUP = 8;\nvar TZD_HOUR_OFFSET_GROUP = 9;\nvar TZD_MINUTE_OFFSET_GROUP = 10;\n\nexports.Parser = function ENISOFormatParser() {\n  Parser.apply(this, arguments);\n\n  this.pattern = function () {\n    return PATTERN;\n  };\n\n  this.extract = function (text, ref, match, opt) {\n    var text = match[0].substr(match[1].length);\n    var index = match.index + match[1].length;\n    var result = new ParsedResult({\n      text: text,\n      index: index,\n      ref: ref\n    });\n    result.start.assign('year', parseInt(match[YEAR_NUMBER_GROUP]));\n    result.start.assign('month', parseInt(match[MONTH_NUMBER_GROUP]));\n    result.start.assign('day', parseInt(match[DATE_NUMBER_GROUP]));\n\n    if (moment(result.start.get('month')) > 12 || moment(result.start.get('month')) < 1 || moment(result.start.get('day')) > 31 || moment(result.start.get('day')) < 1) {\n      return null;\n    }\n\n    if (match[HOUR_NUMBER_GROUP] != null) {\n      result.start.assign('hour', parseInt(match[HOUR_NUMBER_GROUP]));\n      result.start.assign('minute', parseInt(match[MINUTE_NUMBER_GROUP]));\n\n      if (match[SECOND_NUMBER_GROUP] != null) {\n        result.start.assign('second', parseInt(match[SECOND_NUMBER_GROUP]));\n      }\n\n      if (match[MILLISECOND_NUMBER_GROUP] != null) {\n        result.start.assign('millisecond', parseInt(match[MILLISECOND_NUMBER_GROUP]));\n      }\n\n      if (match[TZD_HOUR_OFFSET_GROUP] == null) {\n        result.start.assign('timezoneOffset', 0);\n      } else {\n        var minuteOffset = 0;\n        var hourOffset = parseInt(match[TZD_HOUR_OFFSET_GROUP]);\n        if (match[TZD_MINUTE_OFFSET_GROUP] != null) minuteOffset = parseInt(match[TZD_MINUTE_OFFSET_GROUP]);\n        var offset = hourOffset * 60;\n\n        if (offset < 0) {\n          offset -= minuteOffset;\n        } else {\n          offset += minuteOffset;\n        }\n\n        result.start.assign('timezoneOffset', offset);\n      }\n    }\n\n    result.tags['ENISOFormatParser'] = true;\n    return result;\n  };\n};","map":null,"metadata":{},"sourceType":"script"}